# Dialogmelding
The responsibility of this service is to pull relevant FHIR messages from Kafka, generate a PDF and send it as a Dialogmelding of type DIALOG_NOTAT to the relevant receiver identified by HER-id.

The intent is to use a REST API to generate and return a PDF from a FHIR message json. This convert-api should be implemented by the front-end team according to [the convert operation spec.](http://hl7.org/fhir/resource-operation-convert.html), this is yet to be done.

The PDF is embedded in a XML, [see NAV's dialogmelding doc.](https://www.nav.no/no/nav-og-samfunn/samarbeid/leger-og-andre-behandlere/digital-sykemelding-informasjon-til-den-som-sykmelder/ny-sykmelding-og-dialogmeldinger/digital-sykmelding-og-dialogmeldinger-tekniske-spesifikasjoner), and sent to Emottak over IBM MQ. Emottak adds a XML Digital Signature and routes the Dialogmelding to the receiver using SMTP.

[![](https://mermaid.ink/img/eyJjb2RlIjoic2VxdWVuY2VEaWFncmFtXG4gICAgcGFydGljaXBhbnQgRCBhcyBob3BzLURpYWxvZ21lbGRpbmdcbiAgICBwYXJ0aWNpcGFudCBDIGFzIENvbnZlcnRlclxuICAgIHBhcnRpY2lwYW50IEsgYXMgS2Fma2FcbiAgICBwYXJ0aWNpcGFudCBNIGFzIElCTSBNUVxuICAgIHBhcnRpY2lwYW50IEUgYXMgRW1vdHRha1xuICAgIHBhcnRpY2lwYW50IEggYXMgSGVsc2Vmb3JldGFrXG4gICAgbG9vcFxuICAgIEQtPj5LOiBHZXQgRkhJUiBNZXNzYWdlXG4gICAgYWN0aXZhdGUgS1xuICAgIGFjdGl2YXRlIERcbiAgICBLLT4-RDogRkhJUiBNZXNzYWdlIHtqc29ufVxuICAgIGRlYWN0aXZhdGUgS1xuICAgIEQtPj5DOiBDb252ZXJ0IHRvIFBERiB7anNvbn1cbiAgICBhY3RpdmF0ZSBDXG4gICAgQy0-PkQ6IE9LIHtwZGZ9XG4gICAgZGVhY3RpdmF0ZSBDXG4gICAgRC0-Pk06IFNlbmQgRGlhbG9nbWVsZGluZyB7eG1sfVxuICAgIEQtPj5LOiBVcGRhdGUgb2Zmc2V0XG4gICAgZGVhY3RpdmF0ZSBEXG4gICAgZW5kXG4gICAgbG9vcFxuICAgIE0tPj5FOiBRdWV1ZVxuICAgIGFjdGl2YXRlIEVcbiAgICBFLT4-SDogU01UUFxuICAgIGRlYWN0aXZhdGUgRVxuICAgIGVuZCIsIm1lcm1haWQiOnsidGhlbWUiOiJkZWZhdWx0In0sInVwZGF0ZUVkaXRvciI6ZmFsc2UsImF1dG9TeW5jIjp0cnVlLCJ1cGRhdGVEaWFncmFtIjpmYWxzZX0)](https://mermaid-js.github.io/mermaid-live-editor/edit/#eyJjb2RlIjoic2VxdWVuY2VEaWFncmFtXG4gICAgcGFydGljaXBhbnQgRCBhcyBob3BzLURpYWxvZ21lbGRpbmdcbiAgICBwYXJ0aWNpcGFudCBDIGFzIENvbnZlcnRlclxuICAgIHBhcnRpY2lwYW50IEsgYXMgS2Fma2FcbiAgICBwYXJ0aWNpcGFudCBNIGFzIElCTSBNUVxuICAgIHBhcnRpY2lwYW50IEUgYXMgRW1vdHRha1xuICAgIHBhcnRpY2lwYW50IEggYXMgSGVsc2Vmb3JldGFrXG4gICAgbG9vcFxuICAgIEQtPj5LOiBHZXQgRkhJUiBNZXNzYWdlXG4gICAgYWN0aXZhdGUgS1xuICAgIGFjdGl2YXRlIERcbiAgICBLLT4-RDogRkhJUiBNZXNzYWdlIHtqc29ufVxuICAgIGRlYWN0aXZhdGUgS1xuICAgIEQtPj5DOiBDb252ZXJ0IHRvIFBERiB7anNvbn1cbiAgICBhY3RpdmF0ZSBDXG4gICAgQy0-PkQ6IE9LIHtwZGZ9XG4gICAgZGVhY3RpdmF0ZSBDXG4gICAgRC0-Pk06IFNlbmQgRGlhbG9nbWVsZGluZyB7eG1sfVxuICAgIEQtPj5LOiBVcGRhdGUgb2Zmc2V0XG4gICAgZGVhY3RpdmF0ZSBEXG4gICAgZW5kXG4gICAgbG9vcFxuICAgIE0tPj5FOiBRdWV1ZVxuICAgIGFjdGl2YXRlIEVcbiAgICBFLT4-SDogU01UUFxuICAgIGRlYWN0aXZhdGUgRVxuICAgIGVuZCIsIm1lcm1haWQiOiJ7XG4gIFwidGhlbWVcIjogXCJkZWZhdWx0XCJcbn0iLCJ1cGRhdGVFZGl0b3IiOmZhbHNlLCJhdXRvU3luYyI6dHJ1ZSwidXBkYXRlRGlhZ3JhbSI6ZmFsc2V9)